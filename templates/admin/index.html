<!-- templates/admin/index.html -->
{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block content %}
<div id="content-main">

<!-- Welcome Header -->
<div class="dashboard-card">
    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 20px;">
        <div>
            <h1 style="margin: 0; color: var(--primary); font-size: 1.8em;">Welcome back, {{ request.user.first_name|default:request.user.username }}! 👋</h1>
            <p style="margin: 5px 0 0 0; color: #666;">Here's what's happening with your store today.</p>
        </div>
        <div style="font-size: 0.9em; color: #666;">
            {% now "F j, Y" %}
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div class="stat-card">
        <span class="stat-number">{{ total_products|default:"0" }}</span>
        <span class="stat-label">Total Products</span>
        <a href="{% url 'admin:products_product_changelist' %}" style="display: inline-block; margin-top: 10px; color: var(--primary); text-decoration: none; font-size: 0.8em;">
            View All →
        </a>
    </div>
    
    <div class="stat-card">
        <span class="stat-number">{{ total_orders|default:"0" }}</span>
        <span class="stat-label">Total Orders</span>
        <a href="{% url 'admin:orders_order_changelist' %}" style="display: inline-block; margin-top: 10px; color: var(--primary); text-decoration: none; font-size: 0.8em;">
            View All →
        </a>
    </div>
    
    <div class="stat-card">
        <span class="stat-number">{{ pending_orders|default:"0" }}</span>
        <span class="stat-label">Pending Orders</span>
        <a href="{% url 'admin:orders_order_changelist' %}?order_status__exact=pending" style="display: inline-block; margin-top: 10px; color: var(--primary); text-decoration: none; font-size: 0.8em;">
            Review →
        </a>
    </div>
    
    <div class="stat-card">
        <span class="stat-number">{{ low_stock_count|default:"0" }}</span>
        <span class="stat-label">Low Stock Items</span>
        <a href="{% url 'admin:inventory_inventory_changelist' %}" style="display: inline-block; margin-top: 10px; color: var(--primary); text-decoration: none; font-size: 0.8em;">
            Check →
        </a>
    </div>
</div>

<!-- Quick Actions -->
<div class="dashboard-card">
    <h3 style="margin-top: 0; color: var(--dark);">Quick Actions</h3>
    <div class="quick-actions-grid">
        <a href="{% url 'admin:products_product_add' %}" class="quick-action-btn">
            <span class="icon">📦</span>
            <strong>Add Product</strong>
            <small style="display: block; margin-top: 5px; color: #666;">Create new product</small>
        </a>
        
        <a href="{% url 'admin:orders_order_add' %}" class="quick-action-btn">
            <span class="icon">🛒</span>
            <strong>Create Order</strong>
            <small style="display: block; margin-top: 5px; color: #666;">New customer order</small>
        </a>
        
        <a href="{% url 'admin:products_product_changelist' %}" class="quick-action-btn">
            <span class="icon">📋</span>
            <strong>Manage Products</strong>
            <small style="display: block; margin-top: 5px; color: #666;">View all products</small>
        </a>
        
        <a href="{% url 'admin:orders_order_changelist' %}?order_status__exact=pending" class="quick-action-btn">
            <span class="icon">⏳</span>
            <strong>Pending Orders</strong>
            <small style="display: block; margin-top: 5px; color: #666;">Review orders</small>
        </a>
        
        <a href="{% url 'admin:inventory_inventory_changelist' %}" class="quick-action-btn">
            <span class="icon">📊</span>
            <strong>Inventory</strong>
            <small style="display: block; margin-top: 5px; color: #666;">Stock management</small>
        </a>
        
        <a href="{% url 'admin:users_user_add' %}" class="quick-action-btn">
            <span class="icon">👥</span>
            <strong>Add User</strong>
            <small style="display: block; margin-top: 5px; color: #666;">Create staff account</small>
        </a>
    </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px;">
    <!-- Recent Activity -->
    <div class="dashboard-card">
        <h3 style="margin-top: 0; color: var(--dark);">Recent Activity</h3>
        {% if recent_logs %}
        <div style="max-height: 300px; overflow-y: auto;">
            {% for log in recent_logs %}
            <div style="display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #f0f0f0;">
                <div style="width: 32px; height: 32px; background: var(--light); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px;">
                    {% if log.action_flag == 1 %}➕{% elif log.action_flag == 2 %}✏️{% else %}👁️{% endif %}
                </div>
                <div style="flex: 1;">
                    <div style="font-weight: 500;">{{ log.get_action_flag_display }}</div>
                    <div style="font-size: 0.8em; color: #666;">{{ log.user.get_full_name|default:log.user.username }}</div>
                </div>
                <div style="font-size: 0.8em; color: #666;">{{ log.action_time|timesince }} ago</div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p style="text-align: center; color: #666; padding: 40px 0;">No recent activity</p>
        {% endif %}
    </div>

    <!-- Quick Links -->
    <div class="dashboard-card">
        <h3 style="margin-top: 0; color: var(--dark);">Quick Links</h3>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <a href="{% url 'admin:products_product_changelist' %}?is_active__exact=1" style="display: flex; align-items: center; padding: 12px; background: var(--light); border-radius: 8px; text-decoration: none; color: var(--dark); transition: background 0.3s ease;">
                <span style="margin-right: 10px;">✅</span>
                Active Products
            </a>
            
            <a href="{% url 'admin:products_product_changelist' %}?is_featured__exact=1" style="display: flex; align-items: center; padding: 12px; background: var(--light); border-radius: 8px; text-decoration: none; color: var(--dark); transition: background 0.3s ease;">
                <span style="margin-right: 10px;">⭐</span>
                Featured Products
            </a>
            
            <a href="{% url 'admin:orders_order_changelist' %}?order_status__exact=confirmed" style="display: flex; align-items: center; padding: 12px; background: var(--light); border-radius: 8px; text-decoration: none; color: var(--dark); transition: background 0.3s ease;">
                <span style="margin-right: 10px;">✅</span>
                Confirmed Orders
            </a>
            
            <a href="{% url 'admin:store_category_changelist' %}" style="display: flex; align-items: center; padding: 12px; background: var(--light); border-radius: 8px; text-decoration: none; color: var(--dark); transition: background 0.3s ease;">
                <span style="margin-right: 10px;">📁</span>
                Categories
            </a>
            
            <a href="{% url 'admin:store_brand_changelist' %}" style="display: flex; align-items: center; padding: 12px; background: var(--light); border-radius: 8px; text-decoration: none; color: var(--dark); transition: background 0.3s ease;">
                <span style="margin-right: 10px;">🏷️</span>
                Brands
            </a>
        </div>
    </div>
</div>

<!-- Application Modules (Simplified) -->
<!-- Modern Management Modules Section -->
<div class="dashboard-card" style="margin-top: 20px;">
    <h2 style="
        margin-bottom: 1rem;
        color: #1f2937;
        font-size: 1.6rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
    ">
        <i class="fas fa-th-large" style="color: #2563eb;"></i> Management Modules
    </h2>

    <div style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
    ">
        {% for app in app_list %}
        <div style="
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            border: 1px solid #f2f2f2;
            padding: 18px 20px;
        " onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.08)'; this.style.transform='translateY(-2px)';"
           onmouseout="this.style.boxShadow='0 2px 6px rgba(0,0,0,0.05)'; this.style.transform='none';">

            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <h3 style="
                    margin: 0;
                    color: #2563eb;
                    font-size: 1.2rem;
                    font-weight: 600;
                ">{{ app.name }}</h3>
                <i class="fas fa-layer-group" style="color: #9ca3af;"></i>
            </div>

            <div style="display: flex; flex-direction: column; gap: 8px;">
                {% for model in app.models %}
                <div style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 10px 0;
                    border-bottom: 1px solid #f3f4f6;
                ">
                    <span style="font-weight: 500; color: #374151;">{{ model.name }}</span>
                    <div style="display: flex; gap: 6px;">
                        {% if model.add_url %}
                        <a href="{{ model.add_url }}" style="
                            text-decoration: none;
                            padding: 5px 10px;
                            background: #2563eb;
                            color: white;
                            border-radius: 6px;
                            font-size: 0.8rem;
                            font-weight: 500;
                            transition: background 0.2s ease;
                        " onmouseover="this.style.background='#1e40af'" onmouseout="this.style.background='#2563eb'">
                            <i class="fas fa-plus-circle"></i> Add
                        </a>
                        {% endif %}
                        {% if model.admin_url %}
                        <a href="{{ model.admin_url }}" style="
                            text-decoration: none;
                            padding: 5px 10px;
                            background: #f3f4f6;
                            color: #111827;
                            border-radius: 6px;
                            font-size: 0.8rem;
                            font-weight: 500;
                            transition: background 0.2s ease;
                        " onmouseover="this.style.background='#e5e7eb'" onmouseout="this.style.background='#f3f4f6'">
                            <i class="fas fa-eye"></i> View
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <p style="color: #9ca3af; font-size: 0.9rem;">No models available.</p>
                {% endfor %}
            </div>
        </div>
        {% empty %}
        <p style="color: #9ca3af; font-size: 1rem;">No applications registered.</p>
        {% endfor %}
    </div>
</div>



</div>
{% endblock %}